---
title: "TP N°1"
author: "Joaquina Altamirano y Federico Montagna"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(presentes)
library(ggplot2)
library(tidyr)
```

# Introducción

Los datos del presente informe fueron extraidos de la librería "Presentes", cuyo objetivo es poner a disposición la información oficial sobre víctimas del terrorismo de estado entre 1966 y 1983 provista en:

http://datos.jus.gob.ar/dataset/registro-unificado-de-victimas-del-terrorismo-de-estado-ruvte  
https://www.argentina.gob.ar/sitiosdememoria/ruvte/informe  
http://basededatos.parquedelamemoria.org.ar/registros/ 

De la primera pagina surgen los datos sobre victimas del accionar represivo ilegal que figuran en el Registro Unificado de Victimas del Terrorismo de Estado (RUVTE), programa que depende del Ministerio de Justicia y Derechos Humanos de la Nacion, creado por RES N°1261/14. Segun lo indicado en la pagina web, los datos fueron publicados el 30 de septimebre de 2016 y su ultima fecha de actualizacion fu el 11 de mayo de 2022.

En esta oportunidad, a partir de los datos obetenidos de la pagina web mencionada en el parrafo anterior se construye la tabla denominada, "victimas_con_denuncia". Cabe aclarar que, de la libreria "Presentes" pueden obtenerse otros datasets, igualmente valiosos, que podremos utilizar en otras instancias. 


# Exploración de los datos

```{r}
victimas_con_denuncia <- presentes::victimas_accionar_represivo_ilegal
```

## Base Victimas_con_denuncia
Para el presente TP, seleccionamos la base "victimas_con_denuncia", la cual conforma una tabla con 21 columnas y 8753 observaciones. Las 21 columnas estan conformadas por las variables: Año en que se realiza la denuncia, tipificación según el RUVTE, nombre y apellido paterno, apellido materno, apellido de casada, edad al momento del hecho, numero de documento, año de nacimiento, provincia de nacimiento (se encuentra de dos formas, una de acuerdo al INDEC), país de nacimiento (idem), nacionalidad, embarazo, fecha de detención/secuestro, lugar de detención/secuestro, fecha del asesinato o hallazgo de restos (según corresponda), lugar de asesinato o hallazgo de restos (según corresponda).


```{r}
victimas_con_denuncia|>
  glimpse()
```

## Tomaremos para su lectura, las variables:
- Edad al momento del hecho
- Fecha de secuestro
- Fecha de asesinato o hallazgo de restos
- Embarazos


### Proporcion de valores faltantes

```{r}
victimas_con_denuncia |>
  summarise(edad_al_momento_del_hecho_numerico = mean(is.na(edad_al_momento_del_hecho_numerico)),
            fecha_detencion_secuestro = mean(is.na(fecha_detencion_secuestro)), 
             fecha_asesinato_o_hallazgo_de_restos = mean(is.na(fecha_asesinato_o_hallazgo_de_restos)),
             embarazo = mean(is.na(embarazo)))|>
  pivot_longer(cols =
              c(`edad_al_momento_del_hecho_numerico`:`embarazo`),
               names_to = "variables",
               values_to = "proporcion_nas")
```
A partir de esta tabla podemos sacar las siguientes conclusiones:

1) La proporcion de datos faltantes para la variable edad_al_momento_del_hecho_numerico es pequeña, por lo que se entiende que su media y su desvio estandar son representativos.

2) La proporcion de datos faltantes para la variable fecha_detencion_secuestro es de un 12%, lo cual es un incremento importante respecto de la variable anteriormente analizada. Entendemos que esto responde a la dificultad en muchos casos de conocer la fecha exacta en la que se produjo el hecho de secuestro, desaparición o detención de las personas en cuestión.

3) La proporcion de datos faltantes para la variable fecha_asesinato_o_hallazgo_de_restos es de un 72%, lo cual es un incremento sustancial respecto de las variables anteriormente analizadas. Entendemos que esto responde a la dificultad en muchos casos de encontrar los restos de las personas detenidas/asesinadas/desaparecidas.

4) En el caso de la variable embarazo la proporción de observaciones sin información no resulta relevante, dado que no se conoce la proporción de la muestra que se encuentra en este estado.


# Edad al momento del hecho

#### Media, desvio standar y rango
```{r}
victimas_con_denuncia |>
  filter(!is.na(edad_al_momento_del_hecho_numerico))|>
    summarise( 
    edad_media = mean(edad_al_momento_del_hecho_numerico),
    edad_sd = sd(edad_al_momento_del_hecho_numerico),
    edad_min = min(edad_al_momento_del_hecho_numerico),
    edad_max = max(edad_al_momento_del_hecho_numerico))
```

En un analisis rapido de los datos arrojados podemos ver que las victimas de secuestro y detencion ilegales durante los años 1966 y 1983 en Argentina fue una poblacion joven. Respecto del rango que adquiere esta variable, cabe mencionar que los valores mas bajos representan el secuestro de bebes y niñes.

#### Cantidad de observaciones por edad

```{r}
victimas_con_denuncia|>
  filter(!is.na(edad_al_momento_del_hecho_numerico))|>
  ggplot(aes(x = edad_al_momento_del_hecho_numerico))+
  geom_histogram(binwidth = 0.5, fill = "lightblue")+
  geom_vline(aes(xintercept = mean(edad_al_momento_del_hecho_numerico)),
             color = "red")
```

Este grafico muestra la distribucion de las edades de las personas victimas de secuestro y desaparicion forzada al momento del hecho. Además, se indica en rojo la media de la edad de las victimas.


# Fecha de secuestro

#### Rango
```{r}
victimas_con_denuncia|>
  summarise(fecha_min = min(fecha_detencion_secuestro),
    fecha_max = max(fecha_detencion_secuestro))
```
De la observacion de los datos presentes en la columna fecha_detencion_secuestro surge que no todas las entradas mantienen un criterio unificado, al mismo tiempo que el tipo de variable no permite ordenar y establecer valores maximos y minimos.

#### Cantidad de observaciones por fecha de detención/secuestro

```{r}
victimas_con_denuncia |> 
  mutate(anio_secuestro = substring(fecha_detencion_secuestro, 
                                     nchar(fecha_detencion_secuestro) - 1))|>
  mutate(anio_secuestro = as.numeric(anio_secuestro))|>
  filter(!is.na(anio_secuestro))|>
  ggplot(aes(x = anio_secuestro))+
  geom_histogram(binwidth = 0.5, fill = "lightblue")+
  geom_vline(aes(xintercept = mean(anio_secuestro)),
             color = "red")    
```


## Fecha de asesinato o hallazgo de restos

#### Rango
```{r}
victimas_con_denuncia|>
  summarise(fecha_min = min(fecha_asesinato_o_hallazgo_de_restos),
    fecha_max = max(fecha_asesinato_o_hallazgo_de_restos))
```
De la observacion de los datos presentes en la columna fecha_asesinato_o_hallazgo_de_restos surge que no todas las entradas mantienen un criterio unificado, al mismo tiempo que el tipo de variable no permite ordenar y establecer valores maximos y minimos.

#### Cantidad de observaciones por fecha de asesinato/hallazgo del restos
```{r}
victimas_con_denuncia|>
  filter(!is.na(fecha_asesinato_o_hallazgo_de_restos))|>
  group_by(fecha_asesinato_o_hallazgo_de_restos)|>
  summarise(cantidad = n())
```


## Embarazos

#### Cantidad de observaciones
```{r}
victimas_con_denuncia|>
  filter(!is.na(embarazo))|>
  group_by(embarazo)|>
  summarise(cantidad = n())
```

## Embarazos por año de secuestro

```{r}
victimas_con_denuncia |> 
  mutate(anio_secuestro = substring(fecha_detencion_secuestro, 
                                     nchar(fecha_detencion_secuestro) - 1))|>
  mutate(anio_secuestro = as.numeric(anio_secuestro))|>
  mutate(emba = substring(embarazo,first = 1, last = 10))|>
  filter(!is.na(anio_secuestro) & !is.na(embarazo))|>
  ggplot(aes(x = anio_secuestro))+
  geom_histogram(binwidth = 0.25, fill = "lightblue")+
  geom_vline(aes(xintercept = mean(anio_secuestro)),
             color = "red")
```


## Hipótesis

1) Los primeros años del Proceso de Reorganización Nacional configuraron el momento de mayor cantidad de víctimas de procesos de detención/secuestro/desaparición.

2) En los primeros años de la dictadura civico militar se observa mayor proporción de detenciones a personas jovenes, mientras que con el transcurrir del tiempo esa edad aumenta.

3) ¿Hubo algún momento de la dictadura en la que la proporción de mujeres embarazadas detenidas-desaparecidas fue mayor?


## Hipótesis 1)

1) Los primeros años del Proceso de Reorganización Nacional configuraron el momento de mayor cantidad de víctimas de procesos de detención/secuestro/desaparición.

### Tabla 1
### Cantidad y proporción de víctimas de secuestro por año
```{r}
hipotesis_1 <- victimas_con_denuncia |> 
  mutate(anio_secuestro = substring(fecha_detencion_secuestro, 
                                     nchar(fecha_detencion_secuestro) - 1))|>
  mutate(anio_secuestro = as.numeric(anio_secuestro))|>
  filter(anio_secuestro >= 76 & anio_secuestro <= 83) |> 
  group_by(anio_secuestro) |> 
  summarise(cantidad = n()) |> 
  summarise(anio_secuestro, cantidad, prop = cantidad/sum(cantidad)*100)

hipotesis_1
```

### Gráfico 1
### Proporción de víctimas de secuestro por año
```{r}
hipotesis_1 |>  
  ggplot(aes(x = anio_secuestro, y = prop))+
  geom_col(fill = "lightblue")
```

### Analisis Hipótesis 1

A partir de la tabla y gráfico obtenidos, podemos concluir que la hipótesis planteada se corrobora. Vemos que el primer y segundo año del Procesos de Reorganización Nacional acumulan un total de 86% (6012 personas) de los secuestros/detenciones/desapariciones.



## Hipótesis 2)

2) En los primeros años de la dictadura civico militar se observa mayor proporción de detenciones a personas jovenes, mientras que con el transcurrir del tiempo esa edad aumenta.

### Tabla 2
### Media y desvío de edad al momento del secuestro por año
```{r}
hipotesis_2 <- victimas_con_denuncia |> 
  mutate(anio_secuestro = substring(fecha_detencion_secuestro, 
                                     nchar(fecha_detencion_secuestro) - 1))|>
  mutate(anio_secuestro = as.numeric(anio_secuestro))|>
  filter(anio_secuestro >= 76 & anio_secuestro <= 83 & !is.na(edad_al_momento_del_hecho_numerico)) |> 
  group_by(anio_secuestro) |> 
  summarise(cantidad = n(), media_edad = mean(edad_al_momento_del_hecho_numerico), sd_edad = sd(edad_al_momento_del_hecho_numerico))

hipotesis_2
```


### Gráfico 2
### Media de edad al momento del secuestro por año
```{r}
hipotesis_2 |> 
  ggplot(aes(x = anio_secuestro, y = media_edad))+
  geom_line(color = "lightblue") +
  geom_point(color = "red")
```


### Analisis Hipótesis 2

A partir de la tabla obtenida, observamos que, si bien aumenta con el correr de los años la edad media de las personas detenidas, se trata de un aumento poco significativo, manteniendose hasta el 1982 dentro de un rango de 3 años.


## Hipótesis 3)

3) ¿Hubo algún momento de la dictadura en la que la proporción de mujeres embarazadas detenidas-desaparecidas fue mayor?

### Tabla 3
### Proporción de víctimas de secuestro que cursaban embarazo por año
```{r}
hipotesis_3 <- victimas_con_denuncia |> 
  mutate(anio_secuestro = substring(fecha_detencion_secuestro, 
                                     nchar(fecha_detencion_secuestro) - 1))|>
  mutate(anio_secuestro = as.numeric(anio_secuestro))|>
  mutate(emba = substring(embarazo,first = 1, last = 10))|>
  filter(anio_secuestro >= 76 & anio_secuestro <= 83) |>
  group_by(anio_secuestro) |> 
  summarise(desap_total = n(), embarazos = sum(!is.na(emba)), prop = embarazos/desap_total*100)

hipotesis_3
```


### Tabla 3
### Proporción de víctimas de secuestro que cursaban embarazo por año
```{r}
hipotesis_3 |> 
  filter(anio_secuestro != 82) |>
  ggplot(aes(x = anio_secuestro, y = prop))+
  geom_line(color = "lightblue") +
  geom_point(color = "red")
```

Para este gráfico tomamos la decisión de sustraer el valor para el año 1982 dado que la poca cantidad de casos de desapariciones totales (6) daba por resultado un alto porcentaje de víctimas embarazadas (16%) que resulta poco representativo.

### Analisis Hipótesis 3

A partir de la tabla y el gráfico obtenidos observamos que 1977 es el año con mayor porporción de víctimas de secuestro que cursaban (al menos aparentemente) un embarazo. Sin embargo, para calcular dicha proporción, tomamos el total de desaparecidos/as para cada año, cuando en realidad consideramos que debieran tomarse únicamente las desaparecidas mujeres, dato del que esta base de datos no dispone.
